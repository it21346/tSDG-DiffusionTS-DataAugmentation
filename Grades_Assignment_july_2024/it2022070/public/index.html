<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<title>Book Database</title> <!-- titlos Book Database -->

		<!-- css -->
		<style>

			body {
				font-family: serif;
				font-size: larger;
				margin: 20px;
				background-color: #a3b18a;
				text-align: center;
				color: white;
			}


			input, select, button {
				display: block;
				width: 50%;
				margin: 10px auto;
				padding: 10px;
				border-radius: 12px;
				color: #ffffff;
				background-color: #a3b18a;
				font-size: large;
				font-family: serif;


			}
			button {
				background-color: #3a5a40;
				color: #ffffff;
				cursor: pointer;
				height: 50px;
				width: 200px;
				border-radius: 12px;

			}


			button:hover {
				background-color: #588157;
			}

			::placeholder {
				color: white;
			}

			#searchResults {
				margin-top: 20px;
				padding: 10px;
				color: #f5f5f5;
				background-color: #304b35;
				border-color: #f5f5f5;
				border-radius: 12px;
				text-align: center;
			}
		</style>

	</head>

	<body>


		<h1><i>Book Database</i></h1> <!-- h epikefalida 1 -->


		<br />

		<hr />
		<h2><i>Add Book</i></h2> <!-- h epikefalida 2 -->


		<form name="addBook" action="http://localhost:3000/books/" method="post">  <!-- dhmiourgw to form addbook me thn methodo post -->

			<p>Author:
				<input type="text" name="author" size="20" maxlength="30" />  <!-- dhmiourgw to input gia ton author-->
			</p>

			<p>Title:
				<input type="text" name="title" size="20" maxlength="30" /> <!-- dhmiourgw to input gia ton titlo-->
			</p>

			<p>Genre:</p> <!-- dhmiourgw ena dropdown box gia ta eidh(genders) twn bibliwn -->
			<select name="genres" >
				<option value="Science fiction">Science fiction</option>
				<option value="Satire">Satire</option>
				<option value="Drama">Drama</option>
				<option value="Action and Adventure">Action and Adventure</option>
				<option value="Romance">Romance</option>
				<option value="Mystery">Mystery</option>
				<option value="Horror">Horror</option>
			</select>

			<p>Price:
				<input type="text" name="price" size="20" maxlength="30" /> <!-- dhmiourgw to input gia thn timh -->
			</p>

			<button type="button" onclick="submitBook()">Add Book</button> <!-- dhmiourgw to button Add Book to opoio kanei submit to biblio -->

		</form>

		<br />

		<hr />

		<h2><i>Search Books by Keyword</i></h2> <!-- h epikefalida 3 -->

		<br />

		<form id="searchBook" action="http://localhost:3000/books/id" method="get"> <!-- dhmiourgw to for searchBook me thn methodo get -->

			<input type="text" id="keyword" name="keyword" placeholder="Enter keyword..." /> <!-- dhmiourgw to input gia to keyword -->
			<button type="button" onclick="searchBooks()">Search</button> <!-- dhmiourgw to button Search to opoio kanei search ta biblia -->

		</form>

		<div id="searchResults"></div>

		<!-- javascript -->
		<script>
			document.getElementById("searchBook").addEventListener("submit", function(event) {
				event.preventDefault(); //to preventdefault() apotrepei thn default upobolh tou form
				searchBooks(); //kalw thn leitourgeia ths anazhthshs
			});



			function submitBook() {

				const author = document.forms["addBook"]["author"].value;
				const title = document.forms["addBook"]["title"].value;
				const genre = document.forms["addBook"]["genres"].value;
				const price = document.forms["addBook"]["price"].value;

				//error mhnuma se periptwsh pou ena h parapanw fields einai blank(kena)
				if (author === "" || title === "" || genre === "" || price === "") {
					alert("Please fill in all fields."); //emfanizetai alert oti prepei na sumplhrwthoun ola ta fields
					return;
				}

				//elegxw gia error se periptwsh pou h timh einai <= 0
				if (!(price > 0)) {
					alert("The price value is incorrect.");//emfanizetai alert oti h timh den einai apodekth
					return;
				}

				//dhmiourgw ta dedomena gia to biblio (author, title, genre, price)
				const data = {
					author: author,
					title: title,
					genre: genre,
					price: price
				};

				//stelnetai to HTTP request ston server me thn methodo POST
				fetch("http://localhost:3000/books/", {
					method: "POST",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify(data)
				})
						.then(response => response.json())
						.then(data => {
							alert(data.message); //emfanizetai mhnuma success
						})
						.catch(error => {
							console.error("Error:", error);
						});
			}

			function searchBooks() {
				const keyword = document.getElementById("keyword").value;

				//elegxw gia kapoio error se periptwsh pou to keyword einai keno
				if (keyword === "") {
					alert("Please fill in the field."); //emfanizetai katallhlo mhnuma oti prepei na sumplhrwthei to field keyword
					return;
				}

				//stelnetai to search request ston server me thn methodo GET
				fetch(`http://localhost:3000/books/${keyword}`, {
					method: "GET"
				})
						.then(response => response.json())
						.then(data => {
							const searchResults = document.getElementById("searchResults");
							searchResults.innerHTML = "";
							if (data.length === 0) {
								searchResults.innerText = "No books found."; //emfanizetai mhnuma se periptwsh pou den brethike kanena biblio me to sugkekrimeno keyword
							} else {
								data.forEach(book => {
									const bookElement = document.createElement("div");
									bookElement.innerHTML = `
                    <p>ID: ${book.id}</p>
                    <p>Author: ${book.author}</p>
                    <p>Title: ${book.title}</p>
                    <p>Genre: ${book.genre}</p>
                    <p>Price: ${book.price}</p>
                `;
									searchResults.appendChild(bookElement);
								});
							}
						})
						.catch(error => {
							console.error("Error:", error);
						});
			}

		</script>

	</body>

<!-- !!!SHMEIWSEIS: -->
<!-- 1.xrhsimopoihsa phges apo ena biblio pou exw sthn katoxh mou gia kapoies apo tis entoles css html  (HTML & CSS - Design and Build Websites
Jon Duckett).
2.xrhsimopoihsa to stackoverflow.
3.xrhsimopoihsa kapoia youtube tutorials (gia thn javascript).
-->


</html>
