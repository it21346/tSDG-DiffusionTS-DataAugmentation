<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Management</title>
</head>
<body>
    <h1>Book Management</h1>
    
    <h2>Καταχώρηση νέου βιβλίου</h2>
    <form id="addBookForm">
        <label>Author:</label>
        <input type="text" id="author" required><br>

        <label>Title:</label>
        <input type="text" id="title" required><br>

        <label>Genre:</label>
        <select id="genre" required>
            <option value="Science fiction">Science fiction</option>
            <option value="Satire">Satire</option>
            <option value="Drama">Drama</option>
            <option value="Action and Adventure">Action and Adventure</option>
            <option value="Romance">Romance</option>
            <option value="Mystery">Mystery</option>
            <option value="Horror">Horror</option>
        </select><br>

        <label>Price:</label>
        <input type="text" id="price" required><br>

        <button type="submit">Add Book</button>
    </form>

    <h2>Αναζήτηση βιβλίου με λέξη κλειδί</h2>
    <form id="searchBookForm">
        <label>Keyword:</label>
        <input type="text" id="keyword" required><br>
        <button type="submit">Search</button>
    </form>

    <div id="searchResults"></div>

    <script>
        document.getElementById('addBookForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var author = document.getElementById('author').value;
            var title = document.getElementById('title').value;
            var genre = document.getElementById('genre').value;
            var price = document.getElementById('price').value;

            if (isNaN(price)) {
                alert('Please enter a valid number for the price.');
                return;
            }

            fetch('http://localhost:3000/books/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ author: author, title: title, genre: genre, price: parseFloat(price) })
            })
            .then(function(response) {
                return response.json();
            })
            .then(function(data) {
                alert(data.message);
            });
        });

        document.getElementById('searchBookForm').addEventListener('submit', function(e) {
            e.preventDefault();
            var keyword = document.getElementById('keyword').value;

            fetch('http://localhost:3000/books/' + keyword)
            .then(function(response) {
                return response.json();
            })
            .then(function(books) {
                var resultsDiv = document.getElementById('searchResults');
                resultsDiv.innerHTML = '';
                if (books.length > 0) {
                    books.forEach(function(book) {
                        var bookDiv = document.createElement('div');
                        bookDiv.textContent = 'ID: ' + book.id + ', Author: ' + book.author + ', Title: ' + book.title + ', Genre: ' + book.genre + ', Price: ' + book.price;
                        resultsDiv.appendChild(bookDiv);
                    });
                } else {
                    resultsDiv.textContent = 'No books found';
                }
            });
        });
    </script>
</body>
</html>
